trigger:
  - staging

variables:
  - name: major
    value: 0
  - name: minor
    value: 1
  - name: patch
    value: 0

name: $(major).$(minor).$(patch)-$(Rev:r)

stages:
  - stage: qa
    displayName: QA
    jobs:
      - job: runSystemTests
        displayName: Run System Tests
        pool:
          vmImage: ubuntu-latest
        steps:
          - task: UseDotNet@2
            displayName: Install DotNet SDK 5.0
            inputs:
              packageType: sdk
              version: 5.0.x
          - task: UseDotNet@2
            displayName: Install DotNet SDK 3.1
            inputs:
              packageType: sdk
              version: 3.1.x
          - task: UseDotNet@2
            displayName: Install DotNet SDK 2.1
            inputs:
              packageType: sdk
              version: 2.1.x
          - task: DotNetCoreCLI@2
            displayName: dotnet restore
            inputs:
              command: restore
              feedsToUse: config
              nugetConfigPath: NuGet.Config
          - task: DotNetCoreCLI@2
            displayName: dotnet build
            inputs:
              command: build
              arguments: --no-restore
          - task: DotNetCoreCLI@2
            displayName: dotnet test
            inputs:
              command: test
              arguments: --no-build
